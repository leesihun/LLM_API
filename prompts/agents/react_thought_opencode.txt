==============================
{user_query}
==============================

Previous thoughts and actions:
{scratchpad}

----------------------------------------------------

Analyze the current situation and determine your next action.

Output EXACTLY ONE thought/action/action input pair:

Thought: [Your reasoning about what to do next]
Action: [Tool name]
Action Input: [Input for the tool]

RULES:
1. Generate EXACTLY ONE Thought/Action/Action Input triplet
2. Stop immediately after generating ONE action
3. The tool will execute and provide an observation
4. Action Input must be ONLY the input for the tool

For python_coder (OpenCode mode):
WARNING: DO NOT WRITE RAW PYTHON CODE IN ACTION INPUT!
- Write NATURAL LANGUAGE INSTRUCTIONS ONLY
- OpenCode will generate and execute the code for you
- Describe WHAT to do, not HOW to code it
- OpenCode has full filesystem access in the workspace
- Include COMPREHENSIVE CONTEXT in Action Input:
  * What is the final goal?
  * What plans/steps led to this point?
  * What has been tried or observed?
  * What outputs/files are expected?
  * Any relevant conversation context

WRONG Action Input examples (DO NOT DO THIS):
❌ import pandas as pd; df = pd.read_csv('data.csv'); print(df.head())
❌ def factorial(n): return 1 if n <= 1 else n * factorial(n-1)
❌ with open('file.txt', 'r') as f: content = f.read()

MINIMAL Action Input (too brief - missing context):
⚠️ Read data.csv and show statistics
⚠️ Create a factorial function

GOOD Action Input (rich context):
✓ Goal: Analyze customer behavior. Context: User wants to understand buying patterns. Task: Read data.csv with pandas, show first 5 rows to verify structure, calculate basic statistics (mean, median, mode for purchase amounts), identify top 3 customers by spending. Save summary to customer_analysis.txt
✓ Goal: Test mathematical functions. Previous step: Need to validate calculations. Task: Create a factorial function that handles edge cases (0, 1, negative numbers), test it with values 0, 1, 5, and 10, print results with clear labels, and save all test outputs to factorial_test.txt
✓ Context: Preprocessing text for analysis. Task: Read the contents of file.txt, count total words, count unique words, find the 10 most common words with their frequencies, and save the analysis to word_stats.json

For websearch and rag:
- Provide a pure search query

Output format:

Thought: [Your reasoning]
Action: [Tool name]
Action Input: [Input for the tool]

FINAL REMINDER FOR python_coder:
Action Input = NATURAL LANGUAGE ONLY (describe the task, not the code!)
Action Input ≠ Python code (OpenCode will write the code for you!)
Include rich context: goals, past steps, observations, expected outputs
Longer, detailed Action Input = Better OpenCode results
